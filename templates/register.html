{% extends "base.html" %}
{% block title %}Create Account - CyberGuard{% endblock %}

{% block content %}
<div class="auth-shell">
  <div class="auth-wrap">

    <!-- Left: Illustration / copy -->
    <section class="auth-panel auth-illustration">
      <div>
        <i class="fa-solid fa-user-shield" style="font-size:32px;"></i>
        <h1 class="big">Create your CyberGuard account</h1>
        <p>Admins manage training & models; users run detection with clear, exportable results. Superadmin approval keeps the perimeter tight.</p>
      </div>
      <ul class="auth-ill-bullets">
        <li>Role-based access (User, Admin, Superadmin)</li>
        <li>Streamlined CSV uploads & clean reports</li>
        <li>Beautiful dashboards and charts</li>
      </ul>
    </section>

    <!-- Right: Form -->
    <section class="auth-panel">
      <div class="auth-content">
        <h2 class="auth-title">Create Account</h2>
        <p class="auth-sub muted-line">Fill in your details to request access.</p>

        {% if immediate_msg %}
          <div style="background:#fff8e1;border:1px solid #f0c36d;border-left:4px solid #f0c36d;padding:10px 12px;border-radius:10px;margin:10px 0;color:#5c3b00;">
            {{ immediate_msg }}
          </div>
        {% endif %}

        <form method="post" class="auth-form" novalidate>
           <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
          <div class="row">
            <label>Full name</label>
            <input class="auth-input" type="text" name="fullname" required value="{{ preset_fullname or '' }}">
          </div>

          <div class="row">
            <label>Email</label>
            <input class="auth-input" type="email" name="email" required value="{{ preset_email or '' }}">
          </div>

          <div class="row">
            <label>Password</label>
            <input class="auth-input" type="password" name="password" required>
            <div class="policy">Must be â‰¥6 chars with upper, lower, number and special character.</div>
          </div>

          <div class="row">
            <label>Role</label>
            <select class="auth-select" name="role">
              <option value="user" {{ 'selected' if (preset_role or 'user')=='user' else '' }}>User / Researcher</option>
              <option value="admin" {{ 'selected' if (preset_role or 'user')=='admin' else '' }}>Admin</option>
            </select>
          </div>

          <div class="auth-actions">
            <button type="submit" class="btn btn-cta btn-wide">
              <i class="fas fa-paper-plane"></i> Request Access
            </button>
            <a href="{{ url_for('login') }}" class="btn outline btn-wide">
              <i class="fas fa-right-to-bracket"></i> Back to Sign In
            </a>
          </div>
        </form>
      </div>
    </section>

  </div>
</div>
{% endblock %}
